<!DOCTYPE html>
<html lang="zh-cn" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="FDXN" />
	
	<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests" />
	
	
	
	<title>Hugo部署与踩坑 ｜ 黄粱一梦</title>
	
    
    
    <meta name="description" content="Hugo的部署 自安装hugo起，至此blog正式部署成功大概过去了半个月 说实话，我也懒得整理部署hugo的指令了，只是简述一下整个hugo部署以来的历程 安装hugo 直接从github上下载，或者clo" />
    

    

	
    
    <link rel="shortcut icon" href="https://FDXN.github.io/images/favicon.ico" />

    <link rel="stylesheet" type="text/css" media="screen" href="https://FDXN.github.iocss/normalize.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://FDXN.github.io/css/zozo.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://FDXN.github.io/css/highlight.css" />

    
    
</head>



<head><style type="text/css">:root {
    --nav-width: 1380px;
    --article-width: 650px;
    --toc-width: 300px;
}

.toc {
    margin: 0 2px 40px 2px;
    border: 1px solid var(--border);
    background: var(--entry);
    border-radius: var(--radius);
    padding: 0.4em;
}

.toc-container.wide {
    position: absolute;
    height: 100%;
    border-right: 1px solid var(--border);
    left: calc((var(--toc-width) + var(--gap)) * -1);
    top: calc(var(--gap) * 2);
    width: var(--toc-width);
}

.wide .toc {
    position: sticky;
    top: var(--gap);
    border: unset;
    background: unset;
    border-radius: unset;
    width: 100%;
    margin: 0 2px 40px 2px;
}

.toc details summary {
    cursor: zoom-in;
    margin-inline-start: 20px;
    padding: 12px 0;
}

.toc details[open] summary {
    font-weight: 500;
}

.toc-container.wide .toc .inner {
    margin: 0;
}

.active {
    font-size: 110%;
    font-weight: 600;
}

.toc ul {
    list-style-type: circle;
}

.toc .inner {
    margin: 0 0 0 20px;
    padding: 0px 15px 15px 20px;
    font-size: 16px;
}

.toc li ul {
    margin-inline-start: calc(var(--gap) * 0.5);
    list-style-type: none;
}

.toc li {
    list-style: none;
    font-size: 0.95rem;
    padding-bottom: 5px;
}

.toc li a:hover {
    color: var(--secondary);
}
</style></head>


<div style="position: fixed; right:10px;max-width:600px; overflow:auto; top: 100px; width: 20vw; bottom:30px">
<aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details >
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">目录</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#hugo%e7%9a%84%e9%83%a8%e7%bd%b2" aria-label="Hugo的部署">Hugo的部署</a><ul>
                            
                    <li>
                        <a href="#%e5%ae%89%e8%a3%85hugo" aria-label="安装hugo">安装hugo</a></li>
                    <li>
                        <a href="#%e6%89%be%e5%88%b0%e5%90%88%e9%80%82%e7%9a%84%e4%b8%bb%e9%a2%98" aria-label="找到合适的主题">找到合适的主题</a></li>
                    <li>
                        <a href="#%e4%bf%ae%e6%94%b9%e5%86%85%e5%ae%b9" aria-label="修改内容">修改内容</a></li>
                    <li>
                        <a href="#%e7%94%9f%e6%88%90%e9%9d%99%e6%80%81%e7%bd%91%e9%a1%b5" aria-label="生成静态网页">生成静态网页</a></li>
                    <li>
                        <a href="#%e6%8e%a8%e9%80%81%e8%87%b3github-1refer-anchor-1" aria-label="推送至github $^{[1]}$">推送至github <a href="#refer-anchor-1">$^{[1]}$</a></a></li>
                    <li>
                        <a href="#%e8%b4%ad%e4%b9%b0%e5%9f%9f%e5%90%8d%e5%b9%b6%e6%98%a0%e5%b0%842refer-anchor-2" aria-label="购买域名并映射$^{[2]}$">购买域名并映射<a href="#refer-anchor-2">$^{[2]}$</a></a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%85%a8%e8%bf%87%e7%a8%8b%e4%b8%ad%e7%9a%84%e8%b8%a9%e5%9d%91" aria-label="全过程中的踩坑">全过程中的踩坑</a><ul>
                            
                    <li>
                        <a href="#%e4%bb%93%e5%ba%93%e5%90%8c%e6%ad%a53refer-anchor-3" aria-label="仓库同步$^{[3]}$">仓库同步<a href="#refer-anchor-3">$^{[3]}$</a></a></li>
                    <li>
                        <a href="#%e6%b8%b2%e6%9f%93" aria-label="渲染">渲染</a></li>
                    <li>
                        <a href="#%e5%9c%a8%e6%b5%8f%e8%a7%88%e5%99%a8%e4%b8%adhttps%e8%af%b7%e6%b1%82http%e8%b5%84%e6%ba%904refer-anchor-4" aria-label="在浏览器中https请求http资源$^{[4]}$">在浏览器中https请求http资源<a href="#refer-anchor-4">$^{[4]}$</a></a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5" aria-label="参考链接">参考链接</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

</div>



<body>
    <div class="main animate__animated animate__fadeInDown">
        <div class="nav_container animated fadeInDown">
    <div class="site_nav" id="site_nav">
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/posts/">Archive</a>
            </li>
            
            <li>
                <a href="/tags/">Tags</a>
            </li>
            
            <li>
                <a href="/about/">About</a>
            </li>
            
        </ul>
    </div>
    <div class="menu_icon">
        <a id="menu_icon"><i class="ri-menu-line"></i></a>
    </div>
</div>
        <div class="header animated fadeInDown">
    <div class="site_title_container">
        <div class="site_title">
            <h1>
                <a href="https://FDXN.github.io">
                    <span>黄粱一梦</span>
                </a>
            </h1>
        </div>
        <div class="description">
            <p class="sub_title">正因是梦，尤需真活。</p>
            <div class="my_socials">
                
                
                <a href="https://space.bilibili.com/8346968" title="bilibili" target="_blank"><i class="ri-bilibili-fill"></i></a>
                
                
                
                <a href="https://github.com/FDXN" title="github" target="_blank"><i class="ri-github-fill"></i></a>
                
                
                
                <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=1005279543&amp;site=qq&amp;menu=yes" title="qq" target="_blank"><i class="ri-qq-fill"></i></a>
                
                
                <a href="https://FDXN.github.io/index.xml" type="application/rss+xml" title="rss" target="_blank"><i
                        class="ri-rss-fill"></i></a>
            </div>
        </div>
    </div>
</div>
        <div class="content">
            <div class="post_page">
                <div class="post animate__animated animate__fadeInDown">
                    <div class="post_title post_detail_title">
                        <h2><a href='/posts/hugo-deployment-debugging/'>Hugo部署与踩坑</a></h2>
                        <span class="date">2021.07.07</span>
                    </div>
                    <div class="post_content markdown"><h2 id="hugo的部署">Hugo的部署</h2>
<p>自安装hugo起，至此blog正式部署成功大概过去了半个月</p>
<p>说实话，我也懒得整理部署hugo的指令了，只是简述一下整个hugo部署以来的历程</p>
<h3 id="安装hugo">安装hugo</h3>
<p>直接从github上下载，或者clone下来</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">git clone https://github.com/gohugoio/hugo
</code></pre></div><h3 id="找到合适的主题">找到合适的主题</h3>
<p>其实就是用别人写好的blog，用别人写好的css,像逛菜市场一样挑一个顺眼的，拼拼凑凑，修修剪剪，缝缝补补</p>
<p>&ldquo;菜市场&quot;↓</p>
<p><a href="https://themes.gohugo.io/">https://themes.gohugo.io/</a></p>
<p>我这里用的是ZOZO主题</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">git clone https://github.com/varkai/hugo-theme-zozo themes/zozo
</code></pre></div><h3 id="修改内容">修改内容</h3>
<p>对于网页什么的，我是一窍不通，唯一一点印象是初中电脑课上学过一丢丢，所以我全是靠作者在<code>config.toml</code>里留下的注释改完的全部，在此再次感谢各位作者</p>
<p>对于markdown语言，我也是一窍不通，但是看了网上的教程后，也是勉强布置完了</p>
<p>这里不贴一下某位启蒙我的dalao实在是不合适</p>
<p><a href="https://lbqaq.top/p/blog%E5%B8%B8%E7%94%A8%E7%9A%84%E5%91%BD%E4%BB%A4/">dalao的整理</a></p>
<h3 id="生成静态网页">生成静态网页</h3>
<p>在根目录下输入</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">hugo -t zozo
</code></pre></div><p>进行渲染，生成<code>public</code>文件</p>
<h3 id="推送至github-1refer-anchor-1">推送至github <a href="#refer-anchor-1">$^{[1]}$</a></h3>
<p>新建一个名为<code>***.github.io</code>的库</p>
<p>这一部分详见<a href="https://fdxn.xyz/posts/git/">Git基本操作</a></p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">cd public
git init
# 仓库初始化
git add .
# 添加所有文件到暂存区
git remote add git@github.com:xxxxxxx
# 指定远程仓库 xxxxxxx修改为自己项目主页的ssh地址
git commit -m &#34;first commit&#34;
# 提交
git push -u origin master
# 推送
</code></pre></div><p>上传成功后，就可以使用<code>***.github.io</code>连接了</p>
<p>更新后再次push</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">git status
git add .
git commit -m &#34;updates&#34;
git push -u origin master
</code></pre></div><h3 id="购买域名并映射2refer-anchor-2">购买域名并映射<a href="#refer-anchor-2">$^{[2]}$</a></h3>
<p>上网购买一个域名，我依旧是在阿里的平台上买的，挑了一个8块一年的，四舍五入就是不要钱</p>
<p>上传CNAME文件，里面为你的域名</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">fdxn.xyz
</code></pre></div><p>ping你的<code>***.github.io</code>域名，得到一个IP
<img src="https://fdxn.oss-cn-hangzhou.aliyuncs.com/image/hugo-ping_github.png" alt="Web Image"></p>
<p>在域名控制台修改域名解析记录
<img src="https://fdxn.oss-cn-hangzhou.aliyuncs.com/image/hugo-dns_analysis.png" alt="Web Image"></p>
<p>添加两个A记录，用得到的IP，一个主机记录为：“www”，一个为“@”，这样通过fdxn.xyz和www.fdxn.xyz都能访问到我的博客了
<img src="https://fdxn.oss-cn-hangzhou.aliyuncs.com/image/hugo-dns_record.png" alt="Web Image"></p>
<p>至此全部部署结束</p>
<h2 id="全过程中的踩坑">全过程中的踩坑</h2>
<p>当然不可能什么事情都如此顺利，一路坎坷，善用搜索引擎。在此特别鸣谢<a href="www.google.com">Google</a>和<a href="www.csdn.net">CSDN</a>两位大哥，没有这两位大哥就没有今天的网页</p>
<h3 id="仓库同步3refer-anchor-3">仓库同步<a href="#refer-anchor-3">$^{[3]}$</a></h3>
<p>每次第一次上传至库的时候，都很顺利，但每次更新上传总是有大问题</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">error: failed to push some refs to &#39;github.com:FDXN/FDXN.github.io&#39; 

hint: Updates were rejected because the remote contains work that you do 
hint: not have locally. This is usually caused by another repository pushing 
hint: to the same ref. You may want to first integrate the remote changes 
hint: (e.g., &#39;git pull ...&#39;) before pushing again. 
hint: See the &#39;Note about fast-forwards&#39; in &#39;git push --help&#39; for details.
</code></pre></div><p>以上问题基本出在git上对它进行了在线修改，但是没有对本地库进行同步</p>
<p>处理办法在<a href="https://fdxn.xyz/posts/git/">Git基本操作</a>中也有提到，实在不行就直接删库</p>
<h3 id="渲染">渲染</h3>
<p>往往一件事情出错，不是表面上看上去那么简单，表面上看上去是渲染出的问题，其实究其根本，还是<code>baseurl</code>设置问题，使得上传后网页无法找到<code>css</code>，它依旧在默认的<code>localhost:1313</code>上查找资源，这当然会丢失，显现出渲染失败的样子</p>
<p><em><strong>看待一个问题 要透过问题看本质</strong></em></p>
<p>右键的<em>检查</em>是个好东西 希望以后的我能记住</p>
<h3 id="在浏览器中https请求http资源4refer-anchor-4">在浏览器中https请求http资源<a href="#refer-anchor-4">$^{[4]}$</a></h3>
<p>这一次我的浏览器依旧显示渲染失败的问题，但是有了经验的我，打开<em>检查</em></p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">Mixed Content: The page at &#39;&lt;URL&gt;&#39; was loaded over HTTPS, but requested an insecure stylesheet &#39;&lt;URL&gt;&#39;. This request has been blocked; the content must be served over HTTPS.
</code></pre></div><p>找到原因并上网查找问题所在</p>
<p>报错原因：
HTTPS 是 HTTP over Secure Socket Layer，以安全为目标的 HTTP 通道，所以在 HTTPS 承载的页面上不允许出现 http 请求，一旦出现就是提示或报错</p>
<p>解决办法：
在页面中加入<code>meta</code>头：</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">header(&#34;Content-Security-Policy: upgrade-insecure-requests&#34;);
</code></pre></div><p>这是一句html的指令，并且我们的html是生成的，所以我们如果一个一个改的话，治标不治本，所以找到<code>head.html</code>这个文件
<img src="https://fdxn.oss-cn-hangzhou.aliyuncs.com/image/hugo-debug.png" alt="Web Image"></p>
<p>在全局中加入这条指令，全局调用，治标治本</p>
<h2 id="参考链接">参考链接</h2>
<!-- raw HTML omitted -->
<ul>
<li>[1] <a href="https://zhuanlan.zhihu.com/p/115219597">使用Hugo搭建个人博客并自动部署到阿里云</a>、<a href="https://aozaki-kuro.com/hugo-deployment-debugging/">Hugo部署与踩坑记</a></li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>[2] <a href="https://www.zhihu.com/question/31377141/answer/384465402">github怎么绑定自己的域名</a></li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>[3] <a href="https://blog.csdn.net/qq_24495287/article/details/83627727">git解决push错误failed to push some refs to的解决</a></li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>[4] <a href="https://blog.csdn.net/s_monster_/article/details/88656073">解决在浏览器中https请求http资源而报警</a></li>
</ul>
</div>
                    <div class="post_footer">
                        
                        <div class="meta">
                            <div class="info">
                                <span class="field tags">
                                    <i class="ri-stack-line"></i>
                                    
                                    <a href="https://FDXN.github.io/tags/hugo/">Hugo</a>
                                    
                                    <a href="https://FDXN.github.io/tags/%E8%AE%B0%E5%BD%95/">记录</a>
                                    
                                </span>
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                
                <div class="doc_comments"></div>
                

            </div>
        </div>
    </div>
    <a id="back_to_top" href="#" class="back_to_top"><i class="ri-arrow-up-s-line"></i></a>
    <footer class="footer">
    <div class="powered_by">
        <a href="https://varkai.com">Designed by VarKai,</a>
        <a href="http://www.gohugo.io/">Proudly published with Hugo</a>
    </div>

    <div class="footer_slogan">
        <span>记录</span>
    </div>
</footer>
    <script src="https://FDXN.github.io/js/jquery-3.5.1.min.js"></script>
<link href="https://FDXN.github.io/css/fancybox.min.css" rel="stylesheet">
<script src="https://FDXN.github.io/js/fancybox.min.js"></script>
<script src="https://FDXN.github.io/js/zozo.js"></script>


<script type="text/javascript" async
    src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\[\[', '\]\]']],
                processEscapes: true,
                processEnvironments: true,
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
                TeX: {
                    equationNumbers: { autoNumber: "AMS" },
                    extensions: ["AMSmath.js", "AMSsymbols.js"]
                }
            }
        });

        MathJax.Hub.Queue(function () {
            
            
            
            var all = MathJax.Hub.getAllJax(), i;
            for (i = 0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>

<style>
    code.has-jax {
        font: inherit;
        font-size: 100%;
        background: inherit;
        border: inherit;
        color: #515151;
    }
</style>




</body>

</html>